if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("upgradedUFI2GroupMentionsComposerPluginCreatorWithTypeaheadViewForDraftjs",["CometMentions.react","CometMentionsLayoutStrategy.react","GroupsCometMentionsContext.react","GroupsCometMentionsViewItemResolver.react","Keys","MentionSpan.react","WeakMentionSpan.react","cometReplaceMentionedTextInEditorState","createCometComposerMentionsEntity","createUpgradedUFI2MentionsComposerPluginAnchorDecorator","getCometComposerMentionsSearch","getEntityMatcher","installUFI2ComposerInputDecorators","react","recoverableViolation","upgradedUFI2MentionsComposerPluginDraftUtils","useCometMentionsLoggingProvider","useCometTypeaheadViewListStrategy","useGroupsCometComposerMentionsDataSourceResolverConfig","usePrevious","useUpgradedUFI2MentionsComposerPluginInstaller"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useCallback,j=b.useEffect,k=b.useImperativeHandle,l=b.useMemo,m=b.useRef,n=b.useState,o={component:c("MentionSpan.react"),strategy:c("getEntityMatcher")(function(a){return a.getType()==="MENTION"})},p={component:c("WeakMentionSpan.react"),strategy:c("getEntityMatcher")(function(a){return a.getType()==="MENTION"?!!((a=a.getData())==null?void 0:a.isWeak):!1})};function a(){return function(a){var b=a.groupID,e=a.postID;function f(){return h.forwardRef(function(a,f){var g=a.inputProps,r=g.composerState,s=g.onBlur,t=g.onComposerStateChange,u=g.onFocus;g=a.onInstallContentBlockToTextWithEntitiesInputMessageMappers;c("useUpgradedUFI2MentionsComposerPluginInstaller")(g);a=n(!1);g=a[0];var v=a[1],w=m(null),x=m(!1);a=n(null);var y=a[0],z=a[1];a=c("useGroupsCometComposerMentionsDataSourceResolverConfig")({groupID:b,limit:5,postID:e,shouldBootstrapOnLayoutEffect:!1});var A=a.bootstrap,B=a.resolver,C=d("upgradedUFI2MentionsComposerPluginDraftUtils").getMaybeEditorState(r),D=c("usePrevious")(r);a=c("useCometTypeaheadViewListStrategy")({viewItemStrategyRenderer:c("GroupsCometMentionsViewItemResolver.react")});j(function(){var a=r.inputState;if(D==null)return;var b=D.inputState;if(a.__type==="editor-state-based"&&(b.__type!=="editor-state-based"||b.__type==="editor-state-based"&&b.editorState!==a.editorState)){b=c("getCometComposerMentionsSearch")(a.editorState);z(b);v(!1)}else return},[r,D]);var E=i(function(a){t(function(b){return babelHelpers["extends"]({},b,{ariaInputs__DRAFTJS_ONLY:a})})},[t]),F=i(function(a){s&&s(a),E()},[s,E]),G=i(function(a){A(),u&&u(a)},[A,u]),H=i(function(a,b){var d=w.current,e=x.current;if(a.keyCode===c("Keys").ESC&&y!=null){e&&(a.preventDefault(),a.stopPropagation());return"MentionsAutocomplete/cancel"}if(d!=null&&e)switch(a.keyCode){case c("Keys").DOWN:a.preventDefault();return"MentionsAutocomplete/next-mention";case c("Keys").RETURN:if(d.hasSelection()){a.preventDefault();return"MentionsAutocomplete/select-mention"}break;case c("Keys").TAB:if(d.hasSelection()){a.preventDefault();return"MentionsAutocomplete/select-mention"}break;case c("Keys").UP:a.preventDefault();return"MentionsAutocomplete/previous-mention"}b&&b(a)},[y]),I=i(function(a){var b=w.current;switch(a){case"MentionsAutocomplete/cancel":v(!0);break;case"MentionsAutocomplete/select-mention":b&&b.select();break;case"MentionsAutocomplete/previous-mention":b&&b.moveUp();break;case"MentionsAutocomplete/next-mention":b&&b.moveDown();break}return"not-handled"},[]),J=i(function(a){var b=r.inputState;if(C==null||b.__type!=="editor-state-based")return;b=c("getCometComposerMentionsSearch")(C);if(b==null){c("recoverableViolation")("Race condition where the user selected a mention but theres no text in the editor","search");return}b=B(b);b=b.searchResult;if(b==null){c("recoverableViolation")("onPressEntry was called and no search result was found for the query","CometComposer");return}E();var d=c("cometReplaceMentionedTextInEditorState")(a,C,b.replaceableString.length,function(a,b){return c("createCometComposerMentionsEntity")(b.key,!1,a)},function(){return a.label});t(function(a){return q(a,d)})},[r,B,E,C,t]),K=c("useCometMentionsLoggingProvider")({context_id:b,context_type:"group",surface:"COMMENT",typeahead_type:"ENTITY"}),L=m(null),M=l(function(){return c("createUpgradedUFI2MentionsComposerPluginAnchorDecorator")(B,L)},[B]);k(f,function(){return{getUpgradedProps:function(a){var b=a.inputProps;a=babelHelpers.objectWithoutPropertiesLoose(a,["inputProps"]);return babelHelpers["extends"]({},a,{inputProps:babelHelpers["extends"]({},b,{composerState:c("installUFI2ComposerInputDecorators")(b.composerState,M,p,o),handleKeyCommand:function(a){return I(a)},keyBindingFn:function(a){return H(a,b.keyBindingFn)},onBlur:F,onFocus:G})})}}});f=i(function(a){x.current=a},[]);var N=i(function(a){if(a)return;E()},[E]),O=i(function(a,b){(a==null||b==null)&&E(),E({"aria-activedescendant":a,"aria-controls":b})},[E]);if(g){x.current=!1;return null}g=L.current;if(g==null){x.current=!1;return null}var P=B(y),Q=P.dataSource;P=P.searchResult;if(P==null||Q==null){x.current=!1;return null}return h.jsx(d("GroupsCometMentionsContext.react").GroupsCometMentionsContextProvider,{groupID:b,children:h.jsx(c("CometMentions.react"),{context:g,dataSource:Q,editorHasFocus:!0,layoutStrategyRenderer:c("CometMentionsLayoutStrategy.react"),loggingProvider:K,onAriaChange:O,onBlur:F,onEntriesUpdated:N,onFocus:G,onSelectedEntry:J,onVisibilityChange:f,position:"below",queryString:P.matchingString,ref:w,viewStrategyRenderer:a})})})}return f}}function q(a,b){var d=a.inputState;if(d.__type==="editor-state-based"){b=babelHelpers["extends"]({},a,{inputState:babelHelpers["extends"]({},d,{editorState:b})});return b}c("recoverableViolation")("Unimplemented: tried to commit a searchable entity as a mention to a UFI2ComposerState "+("with an inputState of type "+d.__type+". ")+'Only the "editor-state-based" type is supported at the moment',"search");return a}g["default"]=a}),98);
__d("createUpgradedUFI2GroupMentionsComposerPluginForDraftjs",["upgradedUFI2GroupMentionsComposerPluginCreatorWithTypeaheadViewForDraftjs"],(function(a,b,c,d,e,f,g){"use strict";a=c("upgradedUFI2GroupMentionsComposerPluginCreatorWithTypeaheadViewForDraftjs")();g["default"]=a}),98);
__d("ProfileCometCreateRootQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4613843045404910"}),null);